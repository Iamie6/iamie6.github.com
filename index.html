<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>摇一摇</title>
	<style>
		div{
			width:200px;
			height:200px;
			background: red;
			margin:50px auto;
			transform-origin: center bottom;
		}
		@-webkit-keyframes shake{
			0%{
				-webkit-transform: rotate(0deg);
			}
			25%{
				-webkit-transform: rotate(15deg);
			}
			50%{

				-webkit-transform: rotate(0deg);
			}
			75%{

				-webkit-transform: rotate(-15deg);
			}
			100%{
				-webkit-transform: rotate(0deg);
			}
		}
		.sheke{
			-webkit-animation:shake 0.4s linear 2;
		}
	</style>
	<script>
	window.onload=function(){
		var oDiv=document.getElementById('div1');
		var lastX=0;
		var lastY=0;
		var lastZ=0;
		if(window.DeviceMotionEvent){
			window.addEventListener('devicemotion',function(ev){
				var a=ev.accelerationIncludingGravity;

				if(
					Math.abs(a.x-lastX)>20||
					Math.abs(a.y-lastY)>20||
					Math.abs(a.z-lastZ)>20
					){
					oDiv.classList.add('sheke');
					lastX=a.x;
					lastY=a.y;
					lastZ=a.z;
				}
			},false);

			oDiv.addEventListener('webkitAnimationEnd',function(){
				alert(1);
				oDiv.classList.remove('sheke');
			},false)
		}
	};
	</script>
</head>
<body>
	<div id="div1"></div>
</body>
</html>